<!DOCTYPE html>
<html>

<head>
    <title>Visitor Arrivals to Malaysia</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Import Vega & Vega-Lite -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>

    <!-- Import pure.css -->
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css"
        integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

    <!-- CSS file -->
    <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">
</head>

<body>
    <div class="page">

        <!-- Header Section -->
        <div class="header">
            <h1>VISITOR ARRIVALS TO MALAYSIA</h1>
            <p class="subtitle">Comprehensive Analysis of Tourism Trends (2019-2025)</p>
        </div>

        <!-- Main Content Section -->
        <div class="pure-g main-content">

            <!-- Left Side: Bar Chart and Controls -->
            <div class="pure-u-1-2 left-panel">

                <!-- Category Tabs -->
                <div class="category-tabs">
                    <button class="tab-button active" onclick="selectCategory('Visitors')" id="tab-visitors">
                        Visitors
                    </button>
                    <button class="tab-button" onclick="selectCategory('Tourists')" id="tab-tourists">
                        Tourists
                    </button>
                    <button class="tab-button" onclick="selectCategory('Excursionists')" id="tab-excursionists">
                        Excursionists
                    </button>
                </div>

                <!-- Toggle Buttons -->
                <div class="toggle-buttons">
                    <button class="toggle-btn active" id="btn-year" onclick="toggleView('year')">Year</button>
                    <button class="toggle-btn" id="btn-month" onclick="toggleView('month')">Month</button>
                </div>

                <!-- Bar Chart Container -->
                <div id="bar-chart" class="vis-container"></div>

                <!-- Year Selection Buttons -->
                <div class="year-buttons" id="year-buttons">
                    <button class="year-btn active" onclick="selectYear('all')" id="year-all">Select all</button>
                    <button class="year-btn" onclick="selectYear(2019)" id="year-2019">2019</button>
                    <button class="year-btn" onclick="selectYear(2020)" id="year-2020">2020</button>
                    <button class="year-btn" onclick="selectYear(2021)" id="year-2021">2021</button>
                    <button class="year-btn" onclick="selectYear(2022)" id="year-2022">2022</button>
                    <button class="year-btn" onclick="selectYear(2023)" id="year-2023">2023</button>
                    <button class="year-btn" onclick="selectYear(2024)" id="year-2024">2024</button>
                    <button class="year-btn" onclick="selectYear(2025)" id="year-2025">2025</button>
                </div>

                <!-- Data Attribution -->
                <div class="data-note">
                    <p>Data as at Jul 2025</p>
                </div>
            </div>

            <!-- Right Side: World Map -->
            <div class="pure-u-1-2 right-panel">
                <h2 class="section-title">Arrivals by Source Country (2024-2025 YTD)</h2>

                <!-- World Map Container -->
                <div id="world-map" class="vis-container"></div>

                <p class="chart-description">
                    Circle size represents number of arrivals. Color indicates growth rate compared to 2024.
                </p>
            </div>
        </div>

        <!-- Bottom Section: Transportation and Country Charts -->
        <div class="bottom-section">
            <div class="pure-g">

                <!-- Transportation Mode Chart -->
                <div class="pure-u-1-2 chart-panel">
                    <h2 class="section-title">Transportation Mode Distribution</h2>
                    <div id="transportation-chart" class="vis-container"></div>
                    <p class="chart-description">
                        Share of arrivals by transportation mode
                    </p>
                </div>

                <!-- Country Arrivals Pie Chart -->
                <div class="pure-u-1-2 chart-panel">
                    <h2 class="section-title">Overall Arrivals by Country</h2>
                    <div id="country-pie-chart" class="vis-container"></div>
                    <p class="chart-description">
                        Distribution of total arrivals by source country (2024-2025 YTD)
                    </p>
                </div>

            </div>
        </div>

    </div>

    <script type="text/javascript">
        let currentCategory = 'Visitors';
        let currentYear = 'all';
        let currentView = 'year'; // 'year' or 'month'

        // Load initial visualizations
        function loadVisualizations() {
            loadBarChart();
            loadWorldMap();
            loadTransportationChart();
            loadCountryPieChart();
        }

        // Load World Map
        function loadWorldMap() {
            const countryData = [
                { "Category": "Visitors", "Country": "Singapore", "Arrivals": 6526262, "Growth_pct": 28.5, "Latitude": 1.3521, "Longitude": 103.8198 },
                { "Category": "Visitors", "Country": "China", "Arrivals": 1441184, "Growth_pct": 37.8, "Latitude": 35.8617, "Longitude": 104.1954 },
                { "Category": "Visitors", "Country": "Indonesia", "Arrivals": 1466923, "Growth_pct": 11.6, "Latitude": -0.7893, "Longitude": 113.9213 },
                { "Category": "Visitors", "Country": "Thailand", "Arrivals": 833610, "Growth_pct": 3.4, "Latitude": 15.8700, "Longitude": 100.9925 },
                { "Category": "Visitors", "Country": "Brunei", "Arrivals": 480916, "Growth_pct": -20.1, "Latitude": 4.5353, "Longitude": 114.7277 },
                { "Category": "Visitors", "Country": "India", "Arrivals": 484791, "Growth_pct": 36.6, "Latitude": 20.5937, "Longitude": 78.9629 },
                { "Category": "Tourists", "Country": "Singapore", "Arrivals": 2718152, "Growth_pct": 4.6, "Latitude": 1.3521, "Longitude": 103.8198 },
                { "Category": "Tourists", "Country": "China", "Arrivals": 1231072, "Growth_pct": 28.8, "Latitude": 35.8617, "Longitude": 104.1954 },
                { "Category": "Tourists", "Country": "Indonesia", "Arrivals": 1288979, "Growth_pct": 12.0, "Latitude": -0.7893, "Longitude": 113.9213 },
                { "Category": "Tourists", "Country": "Thailand", "Arrivals": 593305, "Growth_pct": 9.1, "Latitude": 15.8700, "Longitude": 100.9925 },
                { "Category": "Tourists", "Country": "India", "Arrivals": 382401, "Growth_pct": 28.9, "Latitude": 20.5937, "Longitude": 78.9629 },
                { "Category": "Tourists", "Country": "Brunei", "Arrivals": 314480, "Growth_pct": -19.5, "Latitude": 4.5353, "Longitude": 114.7277 },
                { "Category": "Excursionists", "Country": "Singapore", "Arrivals": 3808110, "Growth_pct": 53.7, "Latitude": 1.3521, "Longitude": 103.8198 },
                { "Category": "Excursionists", "Country": "China", "Arrivals": 240305, "Growth_pct": -8.3, "Latitude": 35.8617, "Longitude": 104.1954 },
                { "Category": "Excursionists", "Country": "Indonesia", "Arrivals": 210112, "Growth_pct": 133.7, "Latitude": -0.7893, "Longitude": 113.9213 },
                { "Category": "Excursionists", "Country": "Thailand", "Arrivals": 177944, "Growth_pct": 9.2, "Latitude": 15.8700, "Longitude": 100.9925 },
                { "Category": "Excursionists", "Country": "Brunei", "Arrivals": 166436, "Growth_pct": -21.4, "Latitude": 4.5353, "Longitude": 114.7277 },
                { "Category": "Excursionists", "Country": "India", "Arrivals": 102390, "Growth_pct": 75.4, "Latitude": 20.5937, "Longitude": 78.9629 }
            ];

            const spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "width": 600,
                "height": 400,
                "projection": { "type": "equirectangular", "center": [100, 10], "scale": 400 },
                "layer": [
                    {
                        "data": {
                            "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/7_others/oceans.topojson",
                            "format": { "type": "topojson", "feature": "oceans" }
                        },
                        "mark": { "type": "geoshape", "fill": "#d4e9f2" }
                    },
                    {
                        "data": {
                            "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/2_symbol_map/js/ne_110m_admin_0_countries.topojson",
                            "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
                        },
                        "mark": { "type": "geoshape", "fill": "#e8e8e8", "stroke": "white", "strokeWidth": 0.5 }
                    },
                    {
                        "data": {
                            "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/2_symbol_map/js/WorldMapWithGraticules.topojson",
                            "format": { "type": "topojson", "feature": "ne_110m_graticules_30" }
                        },
                        "mark": { "type": "geoshape", "fill": null, "stroke": "lightgray", "strokeWidth": 0.3 }
                    },
                    {
                        "data": { "values": countryData },
                        "transform": [{ "filter": "datum.Category == '" + currentCategory + "'" }],
                        "mark": { "type": "circle", "tooltip": true, "stroke": "white", "strokeWidth": 1.5 },
                        "encoding": {
                            "longitude": { "field": "Longitude", "type": "quantitative" },
                            "latitude": { "field": "Latitude", "type": "quantitative" },
                            "size": {
                                "field": "Arrivals", "type": "quantitative", "title": "Arrivals",
                                "scale": { "domain": [100000, 7000000], "range": [100, 3000] },
                                "legend": { "format": ".2s", "orient": "bottom-right" }
                            },
                            "color": {
                                "field": "Growth_pct", "type": "quantitative", "title": "Growth %",
                                "scale": { "domain": [-25, 0, 50, 150], "range": ["#d73027", "#fee08b", "#66c2a5", "#3288bd"] },
                                "legend": { "orient": "bottom-right", "direction": "horizontal" }
                            },
                            "tooltip": [
                                { "field": "Country", "type": "nominal", "title": "Country" },
                                { "field": "Category", "type": "nominal", "title": "Category" },
                                { "field": "Arrivals", "type": "quantitative", "title": "Arrivals", "format": "," },
                                { "field": "Growth_pct", "type": "quantitative", "title": "Growth %", "format": ".1f" }
                            ]
                        }
                    },
                    {
                        "data": { "values": [{ "Longitude": 101.9758, "Latitude": 4.2105, "label": "ðŸ‡²ðŸ‡¾ Malaysia" }] },
                        "mark": { "type": "text", "fontSize": 13, "fontWeight": "bold", "color": "#e74c3c", "dy": -10 },
                        "encoding": {
                            "longitude": { "field": "Longitude", "type": "quantitative" },
                            "latitude": { "field": "Latitude", "type": "quantitative" },
                            "text": { "field": "label", "type": "nominal" }
                        }
                    },
                    {
                        "data": { "values": [{ "Longitude": 101.9758, "Latitude": 4.2105 }] },
                        "mark": { "type": "circle", "size": 200, "color": "#e74c3c", "opacity": 0.8 },
                        "encoding": {
                            "longitude": { "field": "Longitude", "type": "quantitative" },
                            "latitude": { "field": "Latitude", "type": "quantitative" }
                        }
                    }
                ],
                "config": { "view": { "stroke": null } }
            };

            vegaEmbed('#world-map', spec, {
                "actions": false,
                "renderer": "svg"
            }).catch(console.error);
        }

        // Load Transportation Chart
        function loadTransportationChart() {
            const transportData = [
                { "Category": "Visitors", "Transport_Mode": "LAND", "Share_pct": 66.2 },
                { "Category": "Visitors", "Transport_Mode": "AIR", "Share_pct": 28.8 },
                { "Category": "Visitors", "Transport_Mode": "SEA", "Share_pct": 3.7 },
                { "Category": "Visitors", "Transport_Mode": "RAIL", "Share_pct": 1.2 },
                { "Category": "Tourists", "Transport_Mode": "LAND", "Share_pct": 50.3 },
                { "Category": "Tourists", "Transport_Mode": "AIR", "Share_pct": 42.9 },
                { "Category": "Tourists", "Transport_Mode": "SEA", "Share_pct": 5.8 },
                { "Category": "Tourists", "Transport_Mode": "RAIL", "Share_pct": 1.0 },
                { "Category": "Excursionists", "Transport_Mode": "LAND", "Share_pct": 92.7 },
                { "Category": "Excursionists", "Transport_Mode": "AIR", "Share_pct": 5.3 },
                { "Category": "Excursionists", "Transport_Mode": "SEA", "Share_pct": 0.4 },
                { "Category": "Excursionists", "Transport_Mode": "RAIL", "Share_pct": 1.6 }
            ];

            const spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "width": 500,
                "height": 300,
                "data": { "values": transportData },
                "transform": [{ "filter": "datum.Category == '" + currentCategory + "'" }],
                "mark": { "type": "bar", "tooltip": true, "cornerRadiusEnd": 4 },
                "encoding": {
                    "x": {
                        "field": "Transport_Mode", "type": "nominal", "title": "Transport Mode",
                        "axis": { "labelAngle": 0, "labelFontSize": 12, "titleFontSize": 13, "titleFontWeight": 600, "labelColor": "#666" },
                        "sort": "-y"
                    },
                    "y": {
                        "field": "Share_pct", "type": "quantitative", "title": "Share (%)",
                        "axis": { "grid": true, "gridOpacity": 0.2, "labelFontSize": 11, "titleFontSize": 13, "titleFontWeight": 600, "labelColor": "#666" }
                    },
                    "color": {
                        "field": "Transport_Mode", "type": "nominal",
                        "scale": { "domain": ["LAND", "AIR", "SEA", "RAIL"], "range": ["#5EB3B3", "#f39c12", "#3498db", "#9b59b6"] },
                        "legend": null
                    },
                    "tooltip": [
                        { "field": "Transport_Mode", "type": "nominal", "title": "Transport Mode" },
                        { "field": "Share_pct", "type": "quantitative", "title": "Share %", "format": ".1f" },
                        { "field": "Category", "type": "nominal", "title": "Category" }
                    ]
                },
                "config": {
                    "view": { "stroke": null },
                    "axis": { "labelFont": "Roboto, Arial, sans-serif", "titleFont": "Roboto, Arial, sans-serif" }
                }
            };

            vegaEmbed('#transportation-chart', spec, {
                "actions": false,
                "renderer": "svg"
            }).catch(console.error);
        }

        // Load Country Pie Chart
        function loadCountryPieChart() {
            const countryTotals = [
                { "Country": "Singapore", "Arrivals": 6526262 },
                { "Country": "China", "Arrivals": 1441184 },
                { "Country": "Indonesia", "Arrivals": 1466923 },
                { "Country": "Thailand", "Arrivals": 833610 },
                { "Country": "Brunei", "Arrivals": 480916 },
                { "Country": "India", "Arrivals": 484791 }
            ];

            const spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "width": 400,
                "height": 400,
                "data": { "values": countryTotals },
                "mark": { "type": "arc", "innerRadius": 60, "tooltip": true, "stroke": "white", "strokeWidth": 2 },
                "encoding": {
                    "theta": { "field": "Arrivals", "type": "quantitative", "stack": true },
                    "color": {
                        "field": "Country", "type": "nominal",
                        "scale": {
                            "domain": ["Singapore", "China", "Indonesia", "Thailand", "Brunei", "India"],
                            "range": ["#5EB3B3", "#3D9999", "#f39c12", "#e74c3c", "#9b59b6", "#3498db"]
                        },
                        "legend": { "title": "Country", "orient": "right", "labelFontSize": 12, "titleFontSize": 13, "titleFontWeight": 600 }
                    },
                    "tooltip": [
                        { "field": "Country", "type": "nominal", "title": "Country" },
                        { "field": "Arrivals", "type": "quantitative", "title": "Arrivals", "format": "," },
                        { "calculate": "format(datum.Arrivals / 11234670 * 100, '.1f') + '%'", "as": "Percentage", "title": "Share" }
                    ]
                },
                "view": { "stroke": null }
            };

            vegaEmbed('#country-pie-chart', spec, {
                "actions": false,
                "renderer": "svg"
            }).catch(console.error);
        }

        // Category selection
        function selectCategory(category) {
            currentCategory = category;

            // Update active tab
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('tab-' + category.toLowerCase()).classList.add('active');

            // Reload all charts with new category
            loadBarChart();
            loadWorldMap();
            loadTransportationChart();
        }

        // Toggle between Year and Month view
        function toggleView(view) {
            currentView = view;
            currentYear = 'all'; // Reset year selection when toggling

            // Update active toggle button
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('btn-' + view).classList.add('active');

            // Update year buttons visibility
            if (view === 'month') {
                document.getElementById('year-buttons').style.display = 'none';
            } else {
                document.getElementById('year-buttons').style.display = 'flex';
                // Reset to "select all"
                document.querySelectorAll('.year-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById('year-all').classList.add('active');
            }

            // Reload chart
            loadBarChart();
        }

        // Year selection
        function selectYear(year) {
            currentYear = year;

            // Update active button
            document.querySelectorAll('.year-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('year-' + year).classList.add('active');

            // Reload chart
            loadBarChart();
        }

        // Load bar chart based on current view (year or month)
        function loadBarChart() {
            if (currentView === 'year') {
                loadYearlyBarChart();
            } else {
                loadMonthlyBarChart();
            }
        }

        // Load yearly bar chart
        function loadYearlyBarChart() {
            let spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "width": 550,
                "height": 400,
                "data": {
                    "values": [
                        { "Year": 2019, "Category": "Visitors", "Arrivals_millions": 35.0 },
                        { "Year": 2020, "Category": "Visitors", "Arrivals_millions": 6.0 },
                        { "Year": 2021, "Category": "Visitors", "Arrivals_millions": 0.0 },
                        { "Year": 2022, "Category": "Visitors", "Arrivals_millions": 14.0 },
                        { "Year": 2023, "Category": "Visitors", "Arrivals_millions": 29.0 },
                        { "Year": 2024, "Category": "Visitors", "Arrivals_millions": 38.0 },
                        { "Year": 2025, "Category": "Visitors", "Arrivals_millions": 25.0 },
                        { "Year": 2019, "Category": "Tourists", "Arrivals_millions": 26.1 },
                        { "Year": 2020, "Category": "Tourists", "Arrivals_millions": 4.3 },
                        { "Year": 2021, "Category": "Tourists", "Arrivals_millions": 0.0 },
                        { "Year": 2022, "Category": "Tourists", "Arrivals_millions": 10.1 },
                        { "Year": 2023, "Category": "Tourists", "Arrivals_millions": 20.1 },
                        { "Year": 2024, "Category": "Tourists", "Arrivals_millions": 26.3 },
                        { "Year": 2025, "Category": "Tourists", "Arrivals_millions": 17.2 },
                        { "Year": 2019, "Category": "Excursionists", "Arrivals_millions": 8.9 },
                        { "Year": 2020, "Category": "Excursionists", "Arrivals_millions": 1.7 },
                        { "Year": 2021, "Category": "Excursionists", "Arrivals_millions": 0.0 },
                        { "Year": 2022, "Category": "Excursionists", "Arrivals_millions": 3.9 },
                        { "Year": 2023, "Category": "Excursionists", "Arrivals_millions": 8.9 },
                        { "Year": 2024, "Category": "Excursionists", "Arrivals_millions": 11.7 },
                        { "Year": 2025, "Category": "Excursionists", "Arrivals_millions": 7.8 }
                    ]
                },
                "transform": [
                    { "filter": "datum.Category == '" + currentCategory + "'" }
                ],
                "mark": {
                    "type": "bar",
                    "cursor": "pointer",
                    "tooltip": true,
                    "cornerRadiusEnd": 4
                },
                "encoding": {
                    "x": {
                        "field": "Year",
                        "type": "ordinal",
                        "axis": {
                            "labelAngle": 0,
                            "title": null,
                            "labelFontSize": 13,
                            "grid": false,
                            "labelColor": "#666"
                        }
                    },
                    "y": {
                        "field": "Arrivals_millions",
                        "type": "quantitative",
                        "axis": {
                            "title": "Arrivals (millions)",
                            "grid": true,
                            "gridOpacity": 0.2,
                            "labelFontSize": 12,
                            "labelColor": "#666"
                        }
                    },
                    "color": {
                        "value": "#5EB3B3"
                    },
                    "opacity": {
                        "value": 1
                    },
                    "tooltip": [
                        { "field": "Year", "type": "ordinal", "title": "Year" },
                        { "field": "Category", "type": "nominal", "title": "Category" },
                        { "field": "Arrivals_millions", "type": "quantitative", "title": "Arrivals (millions)", "format": ".1f" }
                    ]
                },
                "config": {
                    "view": { "stroke": null },
                    "axis": {
                        "labelFont": "Roboto, Arial, sans-serif",
                        "titleFont": "Roboto, Arial, sans-serif"
                    }
                }
            };

            // Apply year filter if not "all" - make other bars transparent
            if (currentYear !== 'all') {
                spec.encoding.opacity = {
                    "condition": {
                        "test": "datum.Year == " + currentYear,
                        "value": 1
                    },
                    "value": 0.15
                };
            }

            vegaEmbed('#bar-chart', spec, {
                "actions": false,
                "renderer": "svg"
            }).catch(console.error);
        }

        // Load monthly bar chart
        function loadMonthlyBarChart() {
            let spec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "width": 550,
                "height": 400,
                "data": {
                    "values": [
                        { "Year": "2024", "Month": "Jan", "Category": "Visitors", "Arrivals": 2431941, "MonthNum": 1 },
                        { "Year": "2024", "Month": "Feb", "Category": "Visitors", "Arrivals": 2697941, "MonthNum": 2 },
                        { "Year": "2024", "Month": "Mar", "Category": "Visitors", "Arrivals": 3136479, "MonthNum": 3 },
                        { "Year": "2024", "Month": "Apr", "Category": "Visitors", "Arrivals": 2799026, "MonthNum": 4 },
                        { "Year": "2025", "Month": "Jan", "Category": "Visitors", "Arrivals": 3756075, "MonthNum": 1 },
                        { "Year": "2025", "Month": "Feb", "Category": "Visitors", "Arrivals": 2980330, "MonthNum": 2 },
                        { "Year": "2025", "Month": "Mar", "Category": "Visitors", "Arrivals": 3366567, "MonthNum": 3 },
                        { "Year": "2025", "Month": "Apr", "Category": "Visitors", "Arrivals": 3281512, "MonthNum": 4 },
                        { "Year": "2024", "Month": "Jan", "Category": "Tourists", "Arrivals": 1771571, "MonthNum": 1 },
                        { "Year": "2024", "Month": "Feb", "Category": "Tourists", "Arrivals": 1952043, "MonthNum": 2 },
                        { "Year": "2024", "Month": "Mar", "Category": "Tourists", "Arrivals": 2088386, "MonthNum": 3 },
                        { "Year": "2024", "Month": "Apr", "Category": "Tourists", "Arrivals": 1748642, "MonthNum": 4 },
                        { "Year": "2025", "Month": "Jan", "Category": "Tourists", "Arrivals": 2458711, "MonthNum": 1 },
                        { "Year": "2025", "Month": "Feb", "Category": "Tourists", "Arrivals": 1853122, "MonthNum": 2 },
                        { "Year": "2025", "Month": "Mar", "Category": "Tourists", "Arrivals": 2054968, "MonthNum": 3 },
                        { "Year": "2025", "Month": "Apr", "Category": "Tourists", "Arrivals": 1990120, "MonthNum": 4 },
                        { "Year": "2024", "Month": "Jan", "Category": "Excursionists", "Arrivals": 660370, "MonthNum": 1 },
                        { "Year": "2024", "Month": "Feb", "Category": "Excursionists", "Arrivals": 745898, "MonthNum": 2 },
                        { "Year": "2024", "Month": "Mar", "Category": "Excursionists", "Arrivals": 1048093, "MonthNum": 3 },
                        { "Year": "2024", "Month": "Apr", "Category": "Excursionists", "Arrivals": 1050384, "MonthNum": 4 },
                        { "Year": "2025", "Month": "Jan", "Category": "Excursionists", "Arrivals": 1297364, "MonthNum": 1 },
                        { "Year": "2025", "Month": "Feb", "Category": "Excursionists", "Arrivals": 1127208, "MonthNum": 2 },
                        { "Year": "2025", "Month": "Mar", "Category": "Excursionists", "Arrivals": 1311599, "MonthNum": 3 },
                        { "Year": "2025", "Month": "Apr", "Category": "Excursionists", "Arrivals": 1291392, "MonthNum": 4 }
                    ]
                },
                "transform": [
                    { "filter": "datum.Category == '" + currentCategory + "'" },
                    { "calculate": "datum.Year + '-' + datum.Month", "as": "YearMonth" }
                ],
                "mark": {
                    "type": "bar",
                    "cursor": "pointer",
                    "tooltip": true,
                    "cornerRadiusEnd": 4
                },
                "encoding": {
                    "x": {
                        "field": "YearMonth",
                        "type": "ordinal",
                        "axis": {
                            "labelAngle": -45,
                            "title": null,
                            "labelFontSize": 11,
                            "grid": false,
                            "labelColor": "#666"
                        }
                    },
                    "y": {
                        "field": "Arrivals",
                        "type": "quantitative",
                        "axis": {
                            "title": "Arrivals",
                            "grid": true,
                            "gridOpacity": 0.2,
                            "labelFontSize": 12,
                            "labelColor": "#666",
                            "format": ".2s"
                        }
                    },
                    "color": {
                        "field": "Year",
                        "type": "nominal",
                        "scale": {
                            "domain": ["2024", "2025"],
                            "range": ["#3D9999", "#5EB3B3"]
                        },
                        "legend": {
                            "title": "Year",
                            "orient": "top-right",
                            "labelFontSize": 12
                        }
                    },
                    "tooltip": [
                        { "field": "Year", "type": "ordinal", "title": "Year" },
                        { "field": "Month", "type": "nominal", "title": "Month" },
                        { "field": "Category", "type": "nominal", "title": "Category" },
                        { "field": "Arrivals", "type": "quantitative", "title": "Arrivals", "format": "," }
                    ]
                },
                "config": {
                    "view": { "stroke": null },
                    "axis": {
                        "labelFont": "Roboto, Arial, sans-serif",
                        "titleFont": "Roboto, Arial, sans-serif"
                    }
                }
            };

            vegaEmbed('#bar-chart', spec, {
                "actions": false,
                "renderer": "svg"
            }).catch(console.error);
        }

        // Initialize on page load
        window.onload = function () {
            loadVisualizations();
        };
    </script>
</body>

</html>